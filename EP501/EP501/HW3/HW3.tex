\documentclass{article}
\usepackage{graphicx}
\usepackage{fullpage}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{amssymb}
%\usepackage{draftwatermark}

%\SetWatermarkText{DRAFT}
%\SetWatermarkScale{3}
%\SetWatermarkLightness{0.5}

\begin{document}

\title{EP 501 Homework 3:  Least Squares and Interpolation}

\maketitle

~\\
\textbf{Instructions:}  
\begin{itemize}
  \item Submit all source code and publish Matlab results in .pdf form via Canvas.  Please zip all contents of your solution into single file and then submit in a single zip file.    
  \item Discussing the assignment with others is fine, but you must not copy anyone's code.  
  \item I must be able to run your code and produce all results by executing a single top-level Matlab script, e.g. \textsf{assignment1.m} or similar.  
  \item You may use any of the example codes from our course repository:  \url{https://github.com/mattzett/EP501/}.
  \item Do not copy verbatim any other codes (i.e. any source codes other than from our course repository).  You may use other examples as a reference but you must write you own programs (except for those I give you).  
    \item For demonstrating that your code is correct when you turn in the assignment, you must use the test problems given in the assignment text below.  

\end{itemize}
~\\~\\~\\
\textbf{Purpose of this assignment:}  
\begin{itemize}
  \item Learn principles behind data fitting and polynomial approximation.  
  \item Develop good coding and documentation practices, such that your programs are easily understood by others.  
  \item Hone skills of developing, debugging, and testing your own software
  \item Learn how to build programs on top of existing codes
\end{itemize}

\pagebreak

\begin{enumerate}
  \item Least squares and data fitting:  this problem requires use of the example dataset from the repository, \texttt{test\_lsq.mat}, which provides data for $x_i,y_i,\sigma_{yi}$.  
  \begin{itemize}
    \item[(a)] Write a program that performs a linear least squares fit of a set of data to a polynomial of arbitrary order $n$.
    \item[(b)] Use this program to fit the data to a line and a quadratic form.  Plot your results and the data on the same axis so they can be easily compared.  Test your results against the built-in Matlab functions \texttt{polyfit} and \texttt{polyval}.  Which fit looks better (linear or quadratic)?  
    \item[(c)] A more rigorous way of deciding between preferred function forms in fits (e.g. linear, quadratic, cubic, quartic, etc.) is to define a \emph{goodness-of-fit} statistic that quantifies how effective a particular form is a describing a given data set.  The most commonly used goodness of fit statistic is the \emph{reduced Chi-squared statistic} defined by:  
    \begin{equation}
      \chi^2_\nu = \frac{1}{\nu} \sum_i \frac{\left( y_i - f(x_i) \right) ^2}{\sigma_{y,i}^2},
    \end{equation}
    where $x_i$ are the points of the independent variable at which data are sampled, $y_i$ are the data, $f(\cdot)$ is the function which is being fitted to the data (linear, quadratic, cubic, etc.), $\sigma_i$ is the uncertainty of measurement $y_i$ and $\nu$ is the number of degrees of freedom in your fit (number of data points minus number of parameters being estimated).  Write a function that evaluates $\chi^2_\nu$ for a polynomial fit that has been performed.  
    \item[(d)] Use your goodness-of-fit statistic to determine whether is best (in the statistical sense) to fit these data with a linear, quadratic, or cubic polynomial.    
  \end{itemize}
  \item Bilinear interpolation:  this problem requires use of the grid and data from the repository.  
  \begin{itemize}
    \item[(a)]  Write a function that takes in a grid of points describing some independent variable (say $x_i$), and a point to which the data are to be interpolated $x'$ and finds the index $i$ into the array $x_i$ such that:  $x_i \le x' \le x_{i+1}$.  
    \item[(b)]  Use the function from part (a) to construct an additional function that works over a 2D grid $x,y$.  I.e. given two grids $x_i,y_j$ find the indices $i,j$ such that:  $x_i \le x' \le x_{i+1}$ and $y_j \le y' \le y_{j+1}$.
    \item[(c)]  Use your results from parts a and b to create a bilinear interpolation function that takes in a sequence of data points $\{x'_k,y'_k\}$ to which data are being interpolated, a grid $x_i,y_j$, and a dataset $f_{ij}$ that is defined over this grid and produces bilinearly interpolated values of f at the points $\{x'_k,y'_k\}$.  Write your program so that the input points are simply a flat list and not necessarily a 2D grid of points.  
    \item[(d)]  Test your results against Matlab's bilinear interpolation function (\texttt{interp2}) and show that you get the same result.  Use the test data from the repository (\texttt{test\_interp.mat}).  The source grid data are stored in \texttt{xg,yg}, while the value of the function at those points is in \texttt{f2D}.  \texttt{xgi,ygi} are the densely sampled grid point to which the data are to be interpolated for this test.  
  \end{itemize} 
\end{enumerate}

\end{document}
